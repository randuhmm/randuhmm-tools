#!/usr/bin/env bash
#
#

package=`basename $0`

function show_help {
    echo "$package: send a notification using autoremote"
    echo " "
    echo "$package [options] <title> <text>"
    echo " "
    echo "options:"
    echo "-h, --help                show brief help"
    echo "-c, --config              configure autoremote settings"
}

function show_config {
    echo "config!"
}

function join_by { local IFS="$1"; shift; echo "$*"; }

while test $# -gt 0; do
    case "$1" in
        -h|--help)
            show_help
            exit 0
            ;;
        -c|--config)
            show_config
            exit 0
            break
            ;;
        *)
            break
            ;;
    esac
done

if [[ $# -le 0 ]] ; then
    echo 'Error: Missing required argument title'
    show_help
    exit 1
elif [[ $# -le 1 ]] ; then
    echo 'Error: Missing required argument text'
    show_help
    exit 1
fi

TITLE="${1}"
TEXT="${2// /+}"

KEY="XXX"
SCHEME='https://'
DOMAIN='autoremotejoaomgcd.appspot.com'
PATH='/sendnotification'
PARAMS=""\
" key=$KEY"\
" title=$TITLE"\
" text=$TEXT"

URL="${SCHEME}${DOMAIN}${PATH}?`join_by \& $PARAMS`"

/usr/bin/curl --silent "$URL" > /dev/null
